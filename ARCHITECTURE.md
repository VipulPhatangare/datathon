# System Architecture & Data Flow

## ğŸ—ï¸ Architecture Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          FRONTEND (React)                        â”‚
â”‚                     http://localhost:5173                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Login   â”‚  â”‚  Upload  â”‚  â”‚  Results  â”‚  â”‚ Leaderboard  â”‚  â”‚
â”‚  â”‚   Page   â”‚  â”‚   Page   â”‚  â”‚   Page    â”‚  â”‚     Page     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Navbar  â”‚  â”‚        Admin Dashboard                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  (Users | Answer CSV | Configuration)      â”‚  â”‚
â”‚                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚          AuthContext (Session Management)              â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ AXIOS Requests
                            â”‚ (withCredentials: true)
                            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      BACKEND (Express)                           â”‚
â”‚                   http://localhost:4000/api                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                   Express Session                         â”‚  â”‚
â”‚  â”‚         (connect-mongo â†’ MongoDB Session Store)           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   Auth   â”‚  â”‚  Admin   â”‚  â”‚Submissionâ”‚  â”‚ Leaderboard  â”‚  â”‚
â”‚  â”‚  Routes  â”‚  â”‚  Routes  â”‚  â”‚  Routes  â”‚  â”‚   Routes     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚       â”‚             â”‚              â”‚                â”‚           â”‚
â”‚  â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚            Authentication Middleware                    â”‚  â”‚
â”‚  â”‚      (requireAuth, requireAdmin)                        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚               Metrics Computation                        â”‚   â”‚
â”‚  â”‚   (Accuracy, Precision, Recall, F1 Score)               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ Mongoose ODM
                            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       MongoDB Database                           â”‚
â”‚                 mongodb://localhost:27017/analyzer               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  users   â”‚  â”‚  configs â”‚  â”‚ answercsv  â”‚  â”‚ submissions â”‚  â”‚
â”‚  â”‚          â”‚  â”‚          â”‚  â”‚            â”‚  â”‚             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    sessions                               â”‚  â”‚
â”‚  â”‚            (express-session storage)                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“Š Data Flow Diagrams

### 1. Authentication Flow

```
User                Frontend              Backend              MongoDB
  â”‚                    â”‚                     â”‚                    â”‚
  â”œâ”€ Enter Creds â”€â”€â”€â”€â–ºâ”‚                     â”‚                    â”‚
  â”‚                    â”œâ”€ POST /auth/login â–ºâ”‚                    â”‚
  â”‚                    â”‚                     â”œâ”€ Find User â”€â”€â”€â”€â”€â”€â–ºâ”‚
  â”‚                    â”‚                     â”‚â—„â”€ User Data â”€â”€â”€â”€â”€â”€â”¤
  â”‚                    â”‚                     â”‚                    â”‚
  â”‚                    â”‚                     â”œâ”€ bcrypt.compare   â”‚
  â”‚                    â”‚                     â”‚   (verify pass)    â”‚
  â”‚                    â”‚                     â”‚                    â”‚
  â”‚                    â”‚                     â”œâ”€ Create Session â”€â–ºâ”‚
  â”‚                    â”‚                     â”‚                    â”‚
  â”‚                    â”‚â—„â”€ Session Cookie â”€â”€â”¤                    â”‚
  â”‚â—„â”€ User Info â”€â”€â”€â”€â”€â”€â”¤                     â”‚                    â”‚
  â”‚                    â”‚                     â”‚                    â”‚
  â”œâ”€ Navigate â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                     â”‚                    â”‚
  â”‚                    â”œâ”€ Req w/ Cookie â”€â”€â”€â–ºâ”‚                    â”‚
  â”‚                    â”‚                     â”œâ”€ Validate Sessionâ–ºâ”‚
  â”‚                    â”‚                     â”‚â—„â”€ Session Valid â”€â”€â”¤
  â”‚                    â”‚â—„â”€ Authorized â”€â”€â”€â”€â”€â”€â”¤                    â”‚
  â”‚                    â”‚                     â”‚                    â”‚
```

### 2. CSV Upload & Analysis Flow

```
User              Frontend           Backend            MongoDB
  â”‚                  â”‚                  â”‚                  â”‚
  â”œâ”€ Select CSV â”€â”€â”€â”€â–ºâ”‚                  â”‚                  â”‚
  â”‚                  â”œâ”€ Validate        â”‚                  â”‚
  â”‚                  â”‚  (row_id, label) â”‚                  â”‚
  â”‚                  â”‚                  â”‚                  â”‚
  â”œâ”€ Submit â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                  â”‚                  â”‚
  â”‚                  â”œâ”€ POST /submit â”€â”€â–ºâ”‚                  â”‚
  â”‚                  â”‚  (FormData)      â”‚                  â”‚
  â”‚                  â”‚                  â”œâ”€ Check Limit â”€â”€â”€â–ºâ”‚
  â”‚                  â”‚                  â”‚â—„â”€ Count â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚                  â”‚                  â”‚                  â”‚
  â”‚                  â”‚                  â”œâ”€ Get Answer CSVâ–ºâ”‚
  â”‚                  â”‚                  â”‚â—„â”€ Answer Data â”€â”€â”€â”¤
  â”‚                  â”‚                  â”‚                  â”‚
  â”‚                  â”‚                  â”œâ”€ Parse CSV       â”‚
  â”‚                  â”‚                  â”‚  (PapaParse)     â”‚
  â”‚                  â”‚                  â”‚                  â”‚
  â”‚                  â”‚                  â”œâ”€ Compare Data    â”‚
  â”‚                  â”‚                  â”‚  (by row_id)     â”‚
  â”‚                  â”‚                  â”‚                  â”‚
  â”‚                  â”‚                  â”œâ”€ Compute Metrics â”‚
  â”‚                  â”‚                  â”‚  (Accuracy, P/R) â”‚
  â”‚                  â”‚                  â”‚                  â”‚
  â”‚                  â”‚                  â”œâ”€ Save Submissionâ–ºâ”‚
  â”‚                  â”‚                  â”‚                  â”‚
  â”‚                  â”‚â—„â”€ Results â”€â”€â”€â”€â”€â”€â”€â”¤                  â”‚
  â”‚â—„â”€ Display â”€â”€â”€â”€â”€â”€â”€â”¤                  â”‚                  â”‚
  â”‚                  â”‚                  â”‚                  â”‚
```

### 3. Leaderboard Generation Flow

```
Frontend            Backend              MongoDB
   â”‚                   â”‚                    â”‚
   â”œâ”€ GET /leaderboardâ–ºâ”‚                    â”‚
   â”‚                   â”œâ”€ Aggregate â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
   â”‚                   â”‚  Query:            â”‚
   â”‚                   â”‚  - Group by userId â”‚
   â”‚                   â”‚  - Max(accuracy)   â”‚
   â”‚                   â”‚  - Sort desc       â”‚
   â”‚                   â”‚â—„â”€ Aggregated â”€â”€â”€â”€â”€â”€â”¤
   â”‚                   â”‚   Results          â”‚
   â”‚                   â”‚                    â”‚
   â”‚                   â”œâ”€ Get User Info â”€â”€â”€â–ºâ”‚
   â”‚                   â”‚â—„â”€ User Details â”€â”€â”€â”€â”¤
   â”‚                   â”‚                    â”‚
   â”‚                   â”œâ”€ Calculate Ranks   â”‚
   â”‚                   â”‚                    â”‚
   â”‚â—„â”€ Leaderboard â”€â”€â”€â”€â”¤                    â”‚
   â”‚                   â”‚                    â”‚
```

### 4. Admin User Creation Flow

```
Admin             Frontend            Backend           MongoDB
  â”‚                  â”‚                   â”‚                 â”‚
  â”œâ”€ Fill Form â”€â”€â”€â”€â”€â–ºâ”‚                   â”‚                 â”‚
  â”‚  (email/pass)    â”‚                   â”‚                 â”‚
  â”‚                  â”‚                   â”‚                 â”‚
  â”œâ”€ Submit â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                   â”‚                 â”‚
  â”‚                  â”œâ”€ POST /admin/â”€â”€â”€â”€â–ºâ”‚                 â”‚
  â”‚                  â”‚   users           â”‚                 â”‚
  â”‚                  â”‚                   â”œâ”€ Check Admin â”€â”€â–ºâ”‚
  â”‚                  â”‚                   â”‚â—„â”€ Authorized â”€â”€â”€â”¤
  â”‚                  â”‚                   â”‚                 â”‚
  â”‚                  â”‚                   â”œâ”€ Check Existingâ–ºâ”‚
  â”‚                  â”‚                   â”‚â—„â”€ None Found â”€â”€â”€â”¤
  â”‚                  â”‚                   â”‚                 â”‚
  â”‚                  â”‚                   â”œâ”€ Hash Password  â”‚
  â”‚                  â”‚                   â”‚  (bcrypt)       â”‚
  â”‚                  â”‚                   â”‚                 â”‚
  â”‚                  â”‚                   â”œâ”€ Create User â”€â”€â–ºâ”‚
  â”‚                  â”‚                   â”‚                 â”‚
  â”‚                  â”‚â—„â”€ Success â”€â”€â”€â”€â”€â”€â”€â”€â”¤                 â”‚
  â”‚â—„â”€ Confirmation â”€â”€â”¤                   â”‚                 â”‚
  â”‚                  â”‚                   â”‚                 â”‚
```

## ğŸ—„ï¸ Database Schema Relationships

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         USERS                                â”‚
â”‚  _id, email, passwordHash, teamName, role, uploadLimit      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚                  â”‚
                   â”‚ uploadedBy       â”‚ userId
                   â”‚                  â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚     ANSWERCSV       â”‚   â”‚     SUBMISSIONS         â”‚
        â”‚  _id, filename,     â”‚   â”‚  _id, filename,         â”‚
        â”‚  data[], columns[]  â”‚   â”‚  metrics, preview[]     â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      CONFIG         â”‚
â”‚  key, value         â”‚
â”‚  (defaultUploadLim) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     SESSIONS        â”‚
â”‚  (connect-mongo)    â”‚
â”‚  session data       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ Session Management

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     SESSION LIFECYCLE                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. LOGIN
   User â†’ Backend â†’ Create Session in MongoDB
                 â†“
            Set Session Cookie
                 â†“
            Send to Browser

2. AUTHENTICATED REQUEST
   Browser â†’ Include Session Cookie
           â†“
         Backend â†’ Lookup Session in MongoDB
                â†“
              Validate
                â†“
         Return User Data from Session

3. LOGOUT
   User â†’ Backend â†’ Destroy Session in MongoDB
                 â†“
            Clear Cookie
                 â†“
            Send Confirmation

4. EXPIRATION
   After 24 hours (default):
   - Session auto-expires
   - User must login again
   - Old session cleaned up
```

## ğŸ“ File Upload Processing

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  CSV UPLOAD PROCESSING                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Frontend                      Backend
   â”‚                             â”‚
   â”œâ”€ User Selects File         â”‚
   â”œâ”€ PapaParse Preview         â”‚
   â”œâ”€ Validate Columns          â”‚
   â”‚  (row_id, label)           â”‚
   â”‚                             â”‚
   â”œâ”€ Create FormData           â”‚
   â”œâ”€ POST with File â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
   â”‚                             â”œâ”€ Multer Middleware
   â”‚                             â”œâ”€ Save to /uploads/
   â”‚                             â”‚
   â”‚                             â”œâ”€ Read File
   â”‚                             â”œâ”€ PapaParse Full
   â”‚                             â”œâ”€ Validate Structure
   â”‚                             â”‚
   â”‚                             â”œâ”€ Process Data
   â”‚                             â”œâ”€ Compare & Compute
   â”‚                             â”‚
   â”‚                             â”œâ”€ Save to MongoDB
   â”‚                             â”œâ”€ Delete Temp File
   â”‚                             â”‚
   â”‚â—„â”€â”€â”€â”€â”€â”€â”€ Return Results â”€â”€â”€â”€â”¤
```

## ğŸ¯ Metrics Computation Pipeline

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              METRICS COMPUTATION PIPELINE                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

INPUT: User CSV + Canonical Answer CSV
  â”‚
  â”œâ”€ Step 1: Create Maps
  â”‚  - answerMap[row_id] = label
  â”‚  - userMap[row_id] = label
  â”‚
  â”œâ”€ Step 2: Find Common row_ids
  â”‚  - Iterate answer rows
  â”‚  - Check if in user submission
  â”‚  - Build comparison array
  â”‚
  â”œâ”€ Step 3: Compare Labels
  â”‚  - For each common row_id:
  â”‚    predicted = userMap[row_id]
  â”‚    actual = answerMap[row_id]
  â”‚    match = (predicted === actual)
  â”‚
  â”œâ”€ Step 4: Count Matches
  â”‚  - matches = comparisons.filter(m => m.match).length
  â”‚  - accuracy = matches / total
  â”‚
  â”œâ”€ Step 5: Build Confusion Matrix
  â”‚  - For each unique label:
  â”‚    TP = predicted AND actual = label
  â”‚    FP = predicted = label BUT actual â‰  label
  â”‚    FN = predicted â‰  label BUT actual = label
  â”‚
  â”œâ”€ Step 6: Compute Per-Class Metrics
  â”‚  - For each label:
  â”‚    precision[label] = TP / (TP + FP)
  â”‚    recall[label] = TP / (TP + FN)
  â”‚
  â”œâ”€ Step 7: Macro-Average
  â”‚  - precision = avg(all precisions)
  â”‚  - recall = avg(all recalls)
  â”‚
  â””â”€ Step 8: F1 Score
     - f1 = 2 * (P * R) / (P + R)

OUTPUT: { accuracy, precision, recall, f1, matches }
```

## ğŸ” Security Layers

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      SECURITY LAYERS                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Layer 1: HTTPS (Production)
   â””â”€ All traffic encrypted

Layer 2: CORS
   â””â”€ Only allowed origins
   â””â”€ Credentials: true

Layer 3: Session Management
   â””â”€ httpOnly cookies
   â””â”€ Secure flag in production
   â””â”€ SameSite protection

Layer 4: Authentication Middleware
   â””â”€ requireAuth() - Check session
   â””â”€ requireAdmin() - Check role

Layer 5: Input Validation
   â””â”€ File type checking
   â””â”€ File size limits
   â””â”€ CSV structure validation

Layer 6: Password Security
   â””â”€ bcrypt hashing (10 rounds)
   â””â”€ Never store plain text

Layer 7: MongoDB Security
   â””â”€ Authentication enabled
   â””â”€ Connection string secured
   â””â”€ IP whitelisting
```

## ğŸ¨ Component Hierarchy

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          App.jsx                              â”‚
â”‚                     (AuthProvider)                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                               â”‚
         â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
         â”‚  Navbar  â”‚                  â”‚   Routes    â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                              â”‚
                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚                       â”‚               â”‚
                â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
                â”‚   Login    â”‚          â”‚Protectedâ”‚    â”‚ Protected â”‚
                â”‚            â”‚          â”‚ Routes  â”‚    â”‚  Admin    â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜    â”‚  Routes   â”‚
                                             â”‚         â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
                                             â”‚               â”‚
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”       â”‚
                        â”‚                    â”‚       â”‚       â”‚
                   â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”   â”‚  â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”
                   â”‚ Upload  â”‚         â”‚Results â”‚   â”‚  â”‚  Admin  â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚Dashboardâ”‚
                                                     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
                                            â”‚  Submissions  â”‚
                                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                            â”‚  Leaderboard  â”‚
                                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ Request/Response Examples

### Login Request
```http
POST /api/auth/login
Content-Type: application/json

{
  "email": "user@example.com",
  "password": "password123"
}

Response 200:
{
  "message": "Login successful",
  "user": {
    "id": "...",
    "email": "user@example.com",
    "teamName": "Team Alpha",
    "role": "user",
    "uploadLimit": null
  }
}
Set-Cookie: connect.sid=...; Path=/; HttpOnly
```

### Upload Submission
```http
POST /api/submissions/upload
Content-Type: multipart/form-data
Cookie: connect.sid=...

file: [CSV file data]

Response 200:
{
  "message": "Submission processed successfully",
  "submission": {
    "id": "...",
    "filename": "predictions.csv",
    "attemptNumber": 1,
    "metrics": {
      "accuracy": 0.85,
      "precision": 0.83,
      "recall": 0.87,
      "f1": 0.85
    },
    "summary": {
      "rowsCompared": 100,
      "matches": 85,
      "mismatches": 15,
      ...
    }
  }
}
```

---

**This architecture ensures scalability, security, and maintainability!**
